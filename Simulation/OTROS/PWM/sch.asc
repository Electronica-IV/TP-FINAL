Version 4
SHEET 1 3328 2248
WIRE 624 -416 480 -416
WIRE 944 -416 880 -416
WIRE 1024 -416 1008 -416
WIRE 1200 -416 1104 -416
WIRE 1344 -416 1200 -416
WIRE 1488 -416 1344 -416
WIRE 1584 -416 1488 -416
WIRE 1680 -416 1664 -416
WIRE 1808 -416 1744 -416
WIRE 624 -400 624 -416
WIRE 480 -384 480 -416
WIRE 1344 -384 1344 -416
WIRE 880 -368 880 -416
WIRE 1200 -368 1200 -416
WIRE 1488 -368 1488 -416
WIRE 1808 -368 1808 -416
WIRE 560 -352 544 -352
WIRE 480 -288 480 -304
WIRE 544 -288 544 -352
WIRE 544 -288 480 -288
WIRE 624 -288 624 -304
WIRE 688 -288 624 -288
WIRE 480 -272 480 -288
WIRE 624 -272 624 -288
WIRE -128 -256 -160 -256
WIRE 144 -256 -128 -256
WIRE 880 -256 880 -288
WIRE 1200 -256 1200 -304
WIRE 1200 -256 880 -256
WIRE 1344 -256 1344 -304
WIRE 1344 -256 1200 -256
WIRE 1488 -256 1488 -304
WIRE 1488 -256 1344 -256
WIRE 1808 -256 1808 -288
WIRE 1808 -256 1488 -256
WIRE 288 -224 256 -224
WIRE 320 -224 288 -224
WIRE 416 -224 400 -224
WIRE 544 -224 544 -288
WIRE 560 -224 544 -224
WIRE 1200 -224 1200 -256
WIRE 1488 -224 1488 -256
WIRE 144 -192 112 -192
WIRE 480 -160 480 -176
WIRE 624 -160 624 -176
WIRE 624 -160 480 -160
WIRE 944 -160 880 -160
WIRE 1024 -160 1008 -160
WIRE 1200 -160 1104 -160
WIRE 1584 -160 1488 -160
WIRE 1680 -160 1664 -160
WIRE 1808 -160 1744 -160
WIRE 112 -144 112 -192
WIRE 112 -144 64 -144
WIRE 480 -144 480 -160
WIRE -128 -112 -128 -256
WIRE -48 -112 -128 -112
WIRE 112 -112 64 -112
WIRE 880 -112 880 -160
WIRE 1200 -112 1200 -160
WIRE 1488 -112 1488 -160
WIRE 1808 -112 1808 -160
WIRE 624 -96 480 -96
WIRE -48 -80 -80 -80
WIRE 624 -80 624 -96
WIRE 480 -64 480 -96
WIRE 560 -32 544 -32
WIRE 880 0 880 -32
WIRE 1200 0 1200 -48
WIRE 1200 0 880 0
WIRE 1488 0 1488 -48
WIRE 1808 0 1808 -32
WIRE 1808 0 1488 0
WIRE 480 32 480 16
WIRE 544 32 544 -32
WIRE 544 32 480 32
WIRE 624 32 624 16
WIRE 688 32 624 32
WIRE 1200 32 1200 0
WIRE 1488 32 1488 0
WIRE 480 48 480 32
WIRE 624 48 624 32
WIRE -80 64 -80 -80
WIRE 112 64 112 -112
WIRE 112 64 -80 64
WIRE 144 64 112 64
WIRE 1200 80 1024 80
WIRE 1664 80 1488 80
WIRE 320 96 256 96
WIRE 416 96 400 96
WIRE 544 96 544 32
WIRE 560 96 544 96
WIRE -128 128 -128 -112
WIRE 144 128 -128 128
WIRE 1024 128 1024 80
WIRE 1200 128 1200 80
WIRE 1488 128 1488 80
WIRE 1664 128 1664 80
WIRE 480 160 480 144
WIRE 624 160 624 144
WIRE 624 160 480 160
WIRE 480 176 480 160
WIRE 1024 256 1024 208
WIRE 1664 256 1664 208
WIRE 1200 304 1200 208
WIRE 1488 304 1488 208
WIRE 1152 320 1040 320
WIRE 1648 320 1536 320
WIRE 1152 368 1024 368
WIRE 1664 368 1536 368
WIRE 1200 496 1200 384
WIRE 1344 496 1344 464
WIRE 1344 496 1200 496
WIRE 1488 496 1488 384
WIRE 1488 496 1344 496
WIRE 1344 512 1344 496
WIRE -48 544 -128 544
WIRE 96 544 -48 544
WIRE -48 560 -48 544
WIRE -128 576 -128 544
WIRE 224 592 224 544
WIRE 96 640 96 544
WIRE 144 640 96 640
WIRE 1344 640 1344 592
WIRE -128 672 -128 640
WIRE -48 672 -48 640
WIRE -48 672 -128 672
WIRE 64 672 -48 672
WIRE 144 672 64 672
WIRE 144 704 -128 704
WIRE 400 704 304 704
WIRE 432 704 400 704
WIRE 576 704 512 704
WIRE 1136 704 912 704
WIRE 1424 704 1328 704
WIRE 1552 704 1504 704
WIRE 1744 704 1552 704
WIRE 1792 704 1744 704
WIRE -128 736 -128 704
WIRE 144 736 32 736
WIRE 400 736 400 704
WIRE 1552 752 1552 704
WIRE 960 768 912 768
WIRE 1072 768 1040 768
WIRE 1136 768 1072 768
WIRE 1072 800 1072 768
WIRE 1376 800 1328 800
WIRE -128 848 -128 816
WIRE 32 848 32 736
WIRE 32 848 -128 848
WIRE -128 864 -128 848
WIRE 1376 864 1376 800
WIRE 1472 864 1376 864
WIRE 1552 864 1552 832
WIRE 1552 864 1472 864
WIRE 1072 896 1072 880
WIRE 1552 912 1552 864
WIRE 1600 912 1552 912
WIRE 1696 912 1664 912
WIRE 1744 912 1744 704
WIRE -128 960 -128 928
WIRE 1552 960 1552 912
WIRE 1472 992 1472 864
WIRE 1696 1024 1696 912
WIRE 1696 1024 1584 1024
WIRE 1744 1024 1744 992
WIRE 1744 1024 1696 1024
WIRE 1744 1072 1744 1024
WIRE 1472 1200 1472 1056
WIRE 1552 1200 1552 1088
WIRE 1552 1200 1472 1200
WIRE 1744 1200 1744 1152
WIRE 1744 1200 1552 1200
WIRE 1552 1216 1552 1200
WIRE 1744 1216 1744 1200
FLAG -128 960 0
FLAG 224 544 VDD
FLAG 224 784 0
FLAG 1344 640 0
FLAG 1024 256 0
FLAG 1200 -160 VDD
FLAG 1024 368 0
FLAG 1200 -416 Vo
FLAG 1200 -224 0
FLAG 1200 32 0
FLAG 1040 320 VGG1
FLAG 1744 1216 0
FLAG 1552 1216 0
FLAG 1072 896 0
FLAG 912 768 fb
FLAG 1792 704 Vo
FLAG 304 672 pwmo
FLAG 400 800 0
FLAG 576 704 cs
FLAG 1344 464 cs
FLAG -160 -256 pwmo
FLAG 480 -416 VDD
FLAG 688 -288 VGG1
FLAG 480 -144 0
FLAG -48 -48 0
FLAG -48 -144 0
FLAG 288 -224 nand
FLAG 480 -96 VDD
FLAG 688 32 VGG2
FLAG 480 176 0
FLAG 112 -192 Q
FLAG 1664 256 0
FLAG 1488 -160 VDD
FLAG 1664 368 0
FLAG 1488 -416 Vo
FLAG 1488 -224 0
FLAG 1488 32 0
FLAG 1648 320 VGG2
FLAG 64 672 fb
FLAG -128 704 vref
FLAG 912 704 vref
FLAG 1344 -416 Vo
SYMBOL res -144 720 R0
SYMATTR InstName R1
SYMATTR Value 18k
SYMBOL cap -144 864 R0
SYMATTR InstName C1
SYMATTR Value 1n
SYMBOL voltage 1024 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vd1
SYMATTR Value 300
SYMBOL ind2 1184 112 R0
SYMATTR InstName L1
SYMATTR Value {L1}
SYMATTR Type ind
SYMBOL ind2 896 -16 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L2
SYMATTR Value {L22}
SYMATTR Type ind
SYMBOL sw 1200 400 M180
SYMATTR InstName S1
SYMATTR Value MYSW
SYMBOL diode 944 -144 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMBOL res 1120 -176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 1m
SYMBOL cap 1184 -112 R0
SYMATTR InstName C2
SYMATTR Value 50µ
SYMBOL ind2 896 -272 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L3
SYMATTR Value {L21}
SYMATTR Type ind
SYMBOL diode 944 -400 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMBOL res 1120 -432 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1m
SYMBOL cap 1184 -368 R0
SYMATTR InstName C3
SYMATTR Value 50µ
SYMBOL res 1328 496 R0
SYMATTR InstName RCS
SYMATTR Value 1
SYMBOL Optos\\4N25 1232 768 M0
SYMATTR InstName U2
SYMBOL res 1520 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 24.6k
SYMBOL res 1728 896 R0
SYMATTR InstName R7
SYMATTR Value 109k
SYMBOL res 1728 1056 R0
SYMATTR InstName R8
SYMATTR Value 2.38k
SYMBOL zener 1488 1056 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value UFZV33B
SYMBOL res 1056 784 R0
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL res 1056 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 5K
SYMBOL res 1536 736 R0
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL cap 1664 896 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 100p
SYMBOL res 528 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL cap 384 736 R0
SYMATTR InstName C5
SYMATTR Value 100p
SYMBOL npn 560 -400 R0
SYMATTR InstName Q7
SYMATTR Value 2N2222
SYMBOL pnp 560 -176 M180
SYMATTR InstName Q8
SYMATTR Value 2N2907
SYMBOL res 464 -400 R0
SYMATTR InstName R17
SYMATTR Value 12k
SYMBOL res 416 -240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 1k
SYMBOL res 416 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 1k
SYMBOL CD4013B 0 -96 R0
WINDOW 39 8 96 Invisible 2
SYMATTR InstName U7
SYMATTR SpiceLine VDD=16 SPEED=1.0 TRIPDT=1e-9
SYMBOL CD4093B 192 -224 R0
WINDOW 39 -5 94 Invisible 2
SYMATTR InstName U8
SYMATTR SpiceLine VDD=16 SPEED=1.0 TRIPDT=1e-9
SYMBOL CD4093B 192 96 R0
WINDOW 39 8 80 Invisible 2
SYMATTR InstName U9
SYMATTR SpiceLine VDD=16 SPEED=1.0 TRIPDT=1e-9
SYMBOL npn 560 -80 R0
SYMATTR InstName Q9
SYMATTR Value 2N2222
SYMBOL pnp 560 144 M180
SYMATTR InstName Q10
SYMATTR Value 2N2907
SYMBOL res 464 -80 R0
SYMATTR InstName R20
SYMATTR Value 12k
SYMBOL npn 416 -272 R0
SYMATTR InstName Q11
SYMATTR Value 2N2222
SYMBOL npn 416 48 R0
SYMATTR InstName Q12
SYMATTR Value 2N2222
SYMBOL voltage 1664 112 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vd2
SYMATTR Value 300
SYMBOL ind2 1504 112 M0
SYMATTR InstName L4
SYMATTR Value {L1}
SYMATTR Type ind
SYMBOL ind2 1792 -16 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L5
SYMATTR Value {L22}
SYMATTR Type ind
SYMBOL sw 1488 400 R180
SYMATTR InstName S2
SYMATTR Value MYSW
SYMBOL diode 1744 -144 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMBOL res 1568 -176 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 1m
SYMBOL cap 1504 -112 M0
SYMATTR InstName C6
SYMATTR Value 50µ
SYMBOL ind2 1792 -272 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L6
SYMATTR Value {L21}
SYMATTR Type ind
SYMBOL diode 1744 -400 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMBOL res 1568 -432 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 1m
SYMBOL cap 1504 -368 M0
SYMATTR InstName C9
SYMATTR Value 50µ
SYMBOL res -64 544 R0
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL cap -144 576 R0
SYMATTR InstName C10
SYMATTR Value 100p
SYMBOL UCC28C42_STEADY 224 688 R0
WINDOW 0 35 -98 Bottom 2
WINDOW 3 4 131 Top 2
SYMATTR InstName U4
SYMBOL res 1328 -400 R0
SYMATTR InstName R3
SYMATTR Value 120
SYMBOL TL431 1552 1024 R180
SYMATTR InstName U1
TEXT 880 32 Left 2 !K1 L1 L2 L3 1
TEXT -136 1024 Left 2 !.model MYSW SW(Ron=0.01 Roff=10Meg Vt=.5 Vh=.4 Lser=0 Vser=0)
TEXT -136 1104 Left 2 !.tran 100m
TEXT -136 1064 Left 2 !.param Fsw=50k Ts={1/Fsw} D=0.25 Ton={D*Ts}
TEXT -136 1144 Left 2 !.param AL=4700n N1=25 N21=28 N22=4
TEXT -136 1184 Left 2 !.param L1={AL*N1*N1} L21={AL*N21*N21} L22={AL*N22*N22}
TEXT 1656 40 Left 2 !K2 L4 L5 L6 1
